<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Manage Trivia Questions</title>
  </head>
  <body>
    <h1>Manage Trivia Questions</h1>

    <!-- Create a Question -->
    <form action="/triviaGame/trivia-questions" method="POST" id="createForm">
      <!-- Question -->
      <label for="question">Question:</label>
      <input
        type="text"
        id="question"
        name="question"
        placeholder="Enter your trivia question"
        required
        minlength="5"
        maxlength="200"
      />
      <br />

      <!-- Correct Answer -->
      <label for="correct_answer">Correct Answer:</label>
      <input
        type="text"
        id="correct_answer"
        name="correct_answer"
        placeholder="Enter the correct answer"
        required
      />
      <br />

      <!-- Incorrect Answers -->
      <label for="incorrect_answers"
        >Incorrect Answers (comma-separated):</label
      >
      <input
        type="text"
        id="incorrect_answers"
        name="incorrect_answers"
        placeholder="Enter incorrect answers separated by commas"
        required
        pattern="[^,]+(,[^,]+)*"
        title="Please enter at least one incorrect answer, separated by commas."
      />
      <br />

      <!-- Submit -->
      <button type="submit">Create Trivia Question</button>
    </form>

    <!-- Search form -->
    <form action="/triviaGame/manage" method="GET">
      <input
        type="text"
        name="q"
        placeholder="Search by question..."
        required
      />
      <button type="submit">Search</button>
    </form>

    <!-- Questions -->
    <h2>
      <% if (searchResults && searchResults.length > 0) { %>Search Results<% }
      else { %>Existing Questions<% } %>
    </h2>

    <ul>
      <% if (searchResults && searchResults.length > 0) { %> <%
      searchResults.forEach((question) => { %>
      <li>
        <strong><%= question.question %></strong><br />
        Correct Answer: <%= question.correct_answer %><br />
        Incorrect Answers: <%= Array.isArray(question.incorrect_answers) ?
        question.incorrect_answers.join(", ") : "None provided" %>
      </li>
      <% }); %> <% } else if (triviaQuestions && triviaQuestions.length > 0) {
      %> <% triviaQuestions.forEach((question) => { %>
      <li>
        <strong><%= question.question %></strong><br />
        Correct Answer: <%= question.correct_answer %><br />
        Incorrect Answers: <%= Array.isArray(question.incorrect_answers) ?
        question.incorrect_answers.join(", ") : "None provided" %>
      </li>
      <% }); %> <% } else { %>
      <li>No questions available.</li>
      <% } %>
    </ul>
  </body>
</html>
